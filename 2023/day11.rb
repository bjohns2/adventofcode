test_input = "...#......
.......#..
#.........
..........
......#...
.#........
.........#
..........
.......#..
#...#....."

expanded_input = "....1........
.........2...
3............
.............
.............
........4....
.5...........
............6
.............
.............
.........7...
8....9......."

my_input = ".........................#.........#..................#..............#.......#.....#........................#............#.....#...........#
.............................................#.....................................................#........................................
.......#............#..........#............................................................................................................
.#................................................#........#.............................................#..............................#...
................#.....................#.............................................................................#.......................
........................................................................#....................#................#...........#.................
...........................................#........................................#.......................................................
..................................#......................#.......#...........#..............................................................
..........#.................................................................................................................................
..............................................#..........................................#.....................................#............
..........................................................................#.................................................................
...#................#...........#.......#............................#...............................#......................................
.........................................................................................................................#..................
.............................................................................#........#.............................#....................#..
..........#.....#...............................#..............................................................#...................#........
.........................................................#..................................................................................
.....................#......#.......................#.......................................................................................
.....................................#.....#.......................#.........................#...........#..............#..................#
...................................................................................................#........................................
...............#........................................................#.........................................#............#............
#........................................................................................#..................................................
...............................................................................#............................................................
....................................................#......#.........#..........................#...........................................
...............................................#.....................................................#...........................#..........
.....#............#........................................................................................................................#
...........................................#.................................................................#......#.......................
............#....................#...............................#..........#...............................................................
............................................................#......................................#........................#...............
...........................#.......................................................#..........#......................................#......
...................#..............................................................................................#.........................
....................................................................#......................................................................#
.............#................................#.............................................................................................
........#.........................#..........................................#..................#...........................................
...........................................................................................................#...............#................
........................................#.........#.......#.....................................................#...........................
..#................................................................................#.................................#.............#........
.....................#......#.......................................................................#.......................................
........................................................................................................................................#...
..........#.....#........................................................#............#......................................#..............
.....................................................#.......#..............................................................................
.............................................................................................................#.........#....................
...#.............................................................#........................................................................#.
.............................#.........#.................#.......................#.................#........................................
..............................................#.........................#...................#...............................................
............#............#..........................#.......................................................................................
....................................................................................................................#.......................
...................#...............................................#........................................................................
...................................#............#..........................................................#..............#.....#......#....
.......................#......#...........................................#..............#.........#........................................
............................................................................................................................................
..#............................................................#.....#...............................................#......................
.......#......................................#.........#.....................................................#..........................#..
.........................#...............................................................................#..................................
.............#...............................................................................#..............................................
#........................................#..................#.............#.........#.................................................#.....
............................................................................................................................................
..................................................#........................................................................................#
........#.............#............#...........................................................................#............................
..............#.....................................................................................#.......................................
...................................................................................................................#........................
..................#...........#............#................#...................................#..............................#............
......................................................................#.................#....................#.......................#......
.................................................................................#.........................................#................
............#....................................#......#...................................................................................
......................#.........................................#...........................................................................
.......#....................#.........#....................................................#.......................#............#...........
.............................................................................#......................#.......................................
...#.............#..........................#........#...............#...................................#................#.................
............................................................................................................................................
.................................................................................................#..........................................
.........................#.....#..................................................#...........................................#.......#.....
............................................................................................................................................
............#.....................................................#...............................................................#.........
...#........................#.................#.........................................................#...........#.....................#.
................#....................................#......................................#...............................................
............................................................................................................................................
............................................................................................................................................
...................................#.................................................#.................................#....................
.............#..............................#....................................................#..............#.......................#...
...................................................#.........#..........#..................#................................................
#......#.............#.......#...........................................................................#..................................
.................................................................................#..................#...............#.......................
..........................................................#.................................................................................
.......................................................................................................................................#....
...........#....................................................#......................#...................#................................
.......................................#................................#...................................................................
...................#............................................................................................#........#..........#.......
............................................#....................................................#......#.....................#.............
........#........................#................#...............#.........................................................................
.............#.............#............................................................#............................#......................
...........................................................#................................................................................
........................................#......#.............................#...............................#..............................
................#...........................................................................................................................
.................................................................#................#.................#.......................................
......#.............#...........#.....................................................................................................#.....
.#.......................#...........#......#.............................................#.................................................
........................................................#.................#.................................................................
....................................................................................#.......................................................
...............#..................#.............................#............................#..............#...............#...............
.........................................#.......................................................................#..........................
..#........#........#..............................#........................................................................................
............................................................#.....................#.........................................................
....................................#........................................#...........#......#......#....................................
.......................#.......................#..................................................................................#.........
........#......#.........................................................................................................................#..
..........................................................#..............................................................#..................
...#........................#........................#................#......................#......................#.......................
................................................................#..........#...........#......................................#.............
..............................................#.....................................................#.................................#.....
......................................#.....................................................................................................
..........#......#...............................................................................................#..........................
...........................................#.................#...................#........................................#.................
........................................................................................#......#...........................................#
....................................................................#.......................................................................
.#.......................#................................#..............#.............................................#....................
................................................#...............................................................#...........................
.......................................#.............#.....................................................#...............#................
.............#................#...................................................................#................................#........
.............................................#..........................................#.................................................#.
.................#................................................................#.........................................................
.#..........................................................................................................................................
........................................................................................................................#...................
...........#..........#...........#..............#.......................................................#.......#....................#.....
....#................................................................#......................................................................
...........................................#.................#...............................................#..................#...........
.....................................#....................................#..........#..........#...........................................
.........................................................................................................................#..............#...
.................................................................................#.........#............#...................................
................#......#.............................#.............#........................................................................
#.......#....................#.........#....................................................................................................
.............................................#..............................#.....................................................#.........
...................#.................................................................#......................................................
....................................#................................................................#..............#.......................
...................................................#...........#................................#...........#..............................#
.........................................................................#.....#............................................................
..#.....................#......................#.................................................................#...........#..............
.........................................................................................#.........#........................................
.........#.......................................................................................................................#......#...
.............................#.....#............................#.....#..............#...............................#......................
.............#.............................................#.............................................#.................#................
"

def expanded(map)
  empty_rows = []
  empty_cols = (0...(map.first.size)).to_a
  map.each_with_index do |line, i|
    empty_rows << i if line.uniq == ['.']
    line.each_with_index do |char, j|
      empty_cols.delete(j) if char != '.'
    end
  end
  # puts "empty_rows: #{empty_rows.join(',')}"
  # puts "empty_cols: #{empty_cols.join(',')}"
  empty_rows.reverse.each do |empty_row_index|
    empty_row = ['.']*(map.first.size)
    map.insert(empty_row_index, empty_row)
  end


  map.each do |line|
    empty_cols.reverse.each do |empty_col_index|
      line.insert(empty_col_index, '.')
    end

  end

  map
end

def format_input(input)
  input.split("\n").map{|line| line.split('')}
end

def calculate_distance(first_loc, second_loc)
  distance = (first_loc[0] - second_loc[0]).abs + (first_loc[1] - second_loc[1]).abs 
  # puts "g1: #{first_loc[0]},#{first_loc[1]} / g2: #{second_loc[0]},#{second_loc[1]} / distance #{distance}"
  distance
end

def count_distances(map)
  galaxy_locations = []
  map.each_with_index do |line, i|
    line.each_with_index do |char, j|
      galaxy_locations << [i,j] if char != '.'
    end
  end
  total_distance = 0
  # puts galaxy_locations.map{|loc| loc.join(',')}.join(' -- ')
  galaxy_locations.each_with_index do |first_loc, i|
    # puts i
    # puts galaxy_locations[(i+1)..-1]&.map{|loc| loc.join(',')}&.join(' -- ')
    galaxy_locations[(i+1)..-1]&.each do |second_loc|
      total_distance += calculate_distance(first_loc, second_loc)
    end
  end
  total_distance
end

def solution(input)
  map = format_input(input)
  map = expanded(map)
  count_distances(map)
end

puts solution(my_input)